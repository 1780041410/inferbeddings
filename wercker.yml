box: python:3.6

no-response-timeout: 60
command-timeout: 60

build:
  steps:
    - pip-install

    - script:
        name: install
        code: |
          sudo apt-get update
          sudo apt-get -y install libtcmalloc-minimal4
          pip3 install --upgrade tensorflow pytest-faulthandler
          python3 setup.py install

    - script:
        name: echo python3 information
        code: |
          echo "python3 version $(python3 --version) running"
          echo "pip3 version $(pip3 --version) running"
          ls

test-light:
  steps:
    - pip-install

    - script:
        name: Run unit tests
        code: |
          LD_PRELOAD="/usr/lib/libtcmalloc_minimal.so.4" pytest tests -v
